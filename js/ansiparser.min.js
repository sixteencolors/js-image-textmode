(function(){var t=Object.prototype.hasOwnProperty;this.ANSIParser=function(){function i(c){var d,a;this.tabstop=8;this.linewrap=80;for(d in c)t.call(c,d)&&(a=c[d],this[d]=a)}var j,h,r,k,l,g,f,c,e;l=k=e=c=f=0;h=7;g=[];j="";r=["#000","#a00","#0a0","#a50","#00a","#a0a","#0aa","#aaa","#555","#f55","#5f5","#ff5","#55f","#f5f","#5ff","#fff"];i.prototype.parse_url=function(c){var d;d=new XMLHttpRequest;d.open("GET",c,!1);d.overrideMimeType("text/plain; charset=x-user-defined");d.send(null);return this.parse(d.status===
200||d.status===0?d.responseText:"")};i.prototype.parse=function(q){for(var d,a,b,p,s,q=q.split("");d=q.shift();)if(f===0)switch(d){case "\u001a":f=3;break;case "\u001b":f=1;break;case "\n":c=0;e++;break;case "\r":break;case "\t":for(b=(c+1)%this.tabstop;b-- >0;)this.putpixel(" ");break;default:this.putpixel(d)}else if(f===1)d!=="["?(this.putpixel("\u001b"),this.putpixel("["),f=0):f=2;else if(f===2)if(d.match("[A-Za-z]")){a=function(){var a,c,d,e;d=j.split(";");e=[];a=0;for(c=d.length;a<c;a++)b=d[a],
e.push(parseInt(b));return e}();switch(d){case "m":p=0;for(s=a.length;p<s;p++)d=a[p],d===0?h=7:d===1?h|=8:d===5?h|=128:30<=d&&d<=37?(h&=248,h|=d-30):40<=d&&d<=47&&(h&=143,h|=d-40<<4);break;case "H":case "f":e=(a[0]||1)-1;c=(a[1]||1)-1;e<0&&(e=0);c<0&&(c=0);break;case "A":e-=a[0]||1;e<0&&(e=0);break;case "B":e+=a[0]||1;break;case "C":c+=a[0]||1;break;case "D":c-=a[0]||1;c<0&&(c=0);break;case "E":e+=a[0]||1;c=0;break;case "F":e-=a[0]||1;e>0&&(e=0);c=0;break;case "G":c=(a[0]||1)-1;break;case "s":k=c;
l=e;break;case "u":c=k;e=l;break;case "J":if(a.length===0||a[0]===0){b=a=e+1;for(d=g.length-1;a<=d?b<=d:b>=d;a<=d?b+=1:b-=1)g[b]=null;b=c;for(a=g[e].length-1;c<=a?b<=a:b>=a;c<=a?b+=1:b-=1)g[e][b]=null}else if(a[0]===1){b=0;for(a=e-1;0<=a?b<=a:b>=a;0<=a?b+=1:b-=1)g[b]=null;for(b=0;0<=c?b<=c:b>=c;0<=c?b+=1:b-=1)g[e][b]=null}else a[0]===2&&(e=c=0,g=[]);break;case "K":if(a.length===0||a[0]===0){b=c;for(a=g[e].length-1;c<=a?b<=a:b>=a;c<=a?b+=1:b-=1)g[e][b]=null}else if(a[0]===1)for(b=0;0<=c?b<=c:b>=c;0<=
c?b+=1:b-=1)g[e][b]=null;else a[0]===2&&(g[e]=null)}j="";f=0}else j+=d;else if(f===3)break;else f=0;return[]};i.prototype.putpixel=function(f){g[e]==null&&(g[e]=[]);g[e][c]={ch:f,attr:h};if(++c>=this.linewrap)return c=0,e++};i.prototype.render_canvas=function(c){var d,a,b,e,f,h,i,m,j,k,l,n,o;a=document.createElement("canvas");l=this.linewrap*8;i=g.length*16;a.setAttribute("width",l);a.setAttribute("height",i);b=a.getContext("2d");b.font='16px "8x16"';b.textAlign="left";b.textBaseline="top";f=0;for(n=
g.length-1;0<=n?f<=n:f>=n;0<=n?f+=1:f-=1)if(g[f]!=null){e=0;for(o=g[f].length-1;0<=o?e<=o:e>=o;0<=o?e+=1:e-=1)if(m=g[f][e],m!=null)h=m.attr&15,d=(m.attr&240)>>4,j=e*8,k=f*16,b.fillStyle=r[d],b.fillRect(j,k,8,16),b.fillStyle=r[h],b.fillText(String.fromCharCode(m.ch.charCodeAt(0)&255),j,k)}c.setAttribute("width",l);c.setAttribute("height",i);b=c.getContext("2d");return b.drawImage(a,0,0)};return i}()}).call(this);
